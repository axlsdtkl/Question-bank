选拓扑求出图的情况，求出总共乘了多少，然后倒着求出每个点的加法经过了多少次乘法叠加，复杂度o(n)。